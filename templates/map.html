{% extends "layout.html" %}
{% block title %}Article Feed{% endblock %}
{% block body %}
<header class="sticky bg-base-100 top-0 p-2 flex items-center justify-end  gap-2 ">
    <form class="flex-1">
        <div class="relative">
            <svg class=" absolute left-2.5 top-2.5 h-4 w-4 text-zinc-500 dark:text-zinc-400" fill="none" height="24"
                 stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                 viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.3-4.3"></path>
            </svg>
            <input
                    class="flex h-10 rounded-md border border-input px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 pl-8 w-full bg-white"
                    placeholder="Search locations..." type="search"/>
        </div>
    </form>

    <select class="select select-bordered flex-1">
        <option disabled selected>Apply Filter</option>
        <option>Politicial</option>
        <option>Geology</option>
    </select>

</header>
{% endblock %}

{% block main %}

<script src="//d3js.org/d3.v7.min.js" charset="utf-8"></script>
<script src="//d3js.org/topojson.v3.min.js"></script>

<script>

    const width = window.innerWidth,
        height = window.innerHeight;

    const identity = d3.geoIdentity();
    const path = d3.geoPath(identity);


    const zoom = d3.zoom()
        .scaleExtent([1, 8])
        .on("zoom", zoomed);

    const svg = d3.select("main").append("svg")
        .attr("viewBox", [0, 0, width, height])
        .attr("width", width)
        .attr("height", height)
        .attr("style", "max-width: 100%; height: 100dvh;")
        .on("click", reset);


    d3.json("/dist/topojson.json", function (error, uk) {
        const geojson = topojson.feature(uk, uk.objects.test);

        identity.fitSize([width, height], geojson)

        svg.append("path")
            .datum(geojson)
            .attr("d", path)
            .attr("fill", "none")
            .attr("stroke", "black")
            .attr("stroke-width", 1);

    });

    svg.call(zoom);

    function reset() {
        // states.transition().style("fill", null);
        svg.transition().duration(750).call(
            zoom.transform,
            d3.zoomIdentity,
            d3.zoomTransform(svg.node()).invert([width / 2, height / 2])
        );
    }


    function zoomed(event) {
        const {transform} = event;
        svg.attr("transform", transform);
        svg.attr("stroke-width", 1 / transform.k);
    }


</script>
{% endblock %}